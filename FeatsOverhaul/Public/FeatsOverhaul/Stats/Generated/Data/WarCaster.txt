// =================================== War Caster: Concentration ===================================

// new entry "WarCaster_Bonuses"
// type "PassiveData"
// // War Caster: Concentration
// data "DisplayName" "he4f3eee6gefd2g4105g9e26g544d3321271e;2"
// // You have <LSTag Tooltip="Advantage">Advantage</LSTag> on <LSTag Tooltip="SavingThrow">Saving Throws</LSTag> to maintain <LSTag Tooltip="Concentration">Concentration</LSTag> on a spell.
// data "Description" "h3ad8fdb2g2266g416cgacebg1fad0c63c959;5"
// data "Icon" "PassiveFeature_WarCaster_Bonuses"
// data "Properties" "Highlighted"
// data "Boosts" "Advantage(Concentration)"

// =================================== War Caster: Opportunity Spell ===================================

// new entry "WarCaster_OpportunitySpell"
// type "PassiveData"
// // War Caster: Opportunity Spell
// data "DisplayName" "hd7ac736fg6e54g4383gb286g3a7b3014617a;2"
// // You can use a <LSTag Type="ActionResource" Tooltip="ReactionActionPoint">reaction</LSTag> to cast <LSTag Type="Spell" Tooltip="Target_ShockingGrasp">Shocking Grasp</LSTag> at a target moving out of melee range.
// data "Description" "h85846355g2916g44b3g9067g1e089037591f;3"
// data "Icon" "PassiveFeature_WarCaster_OpportunitySpell"
// data "Boosts" "UnlockInterrupt(Interrupt_WarCaster)"

// Can be used while under the effects of more non-hostile and non-spellcasting restricted Polymorphs, and can also be used while invisible
// Bug Fix: Gnoll's Sudden Rush is properly implementated in the conditions, preventing Opportunity Atacks against them.
// Bug Fix: Can now be used by Invisible player characters.
// Changes: Invisible creatures can be attacked if the entity reacting can see through invisibility.
// Changes: Player characters can now break Sanctuary with an Opportunity Attack.
// + more
new entry "Interrupt_WarCaster"
type "InterruptData"
using "Interrupt_WarCaster"
// War Caster: Opportunity Spell
// data "DisplayName" "h2d5dacb3g8451g40f4g9c14g33df6c96eb6f;2"
// Cast &lt;LSTag Type="Spell" Tooltip="Target_ShockingGrasp"&gt;Shocking Grasp&lt;/LSTag&gt; at a creature moving out of range.
// data "Description" "h2fc6ee3cg6be8g485ag809fgd66b52ba9e53;3"
// data "Icon" "PassiveFeature_WarCaster_OpportunitySpell"
// data "InterruptContext" "OnLeaveAttackRange"
// data "InterruptContextScope" "Self"
// data "Container" "YesNoDecision"
// data "Conditions" "not HasSpellCastBlocked(context.Observer) and IsAbleToReact(context.Observer) and Self(context.Observer, context.Source) and not Self(context.Observer, context.Target) and Enemy() and not WieldingWeapon('Ammunition', false, false, context.Source) and not HasStatus('SG_Incapacitated', context.Source) and not HasStatus('SG_Unconscious', context.Source) and not (not Player(context.Source) and Tagged('AI_IGNORED_TARGET')  and not HasStatus('GNOLL_SUDDENRUSH')) and not HasStatus('SHOCKWAVE') and not (HasStatus('MOBILE_NO_AOO', context.Source) and HasStatus('MOBILE_NO_AOO_SOURCE', context.Target)) and not HasStatus('FLAMING_SPHERE_AURA') and not HasStatus('SNEAKING',context.Target) and not HasStatus('SG_Ignore_AOO',context.Target) and not AnyEntityIsItem()"
data "Conditions" "(Player(context.Observer) or not HasStatus('SG_Invisible', context.Observer)) and not HasSpellCastBlocked(context.Observer) and IsAbleToReact(context.Observer) and Self(context.Observer, context.Source) and not Self(context.Observer, context.Target) and Enemy() and (Player(context.Source) or not HasStatus('SANCTUARY', context.Source)) and not WieldingWeapon('Ammunition', false, false, context.Source) and not HasStatus('SG_Incapacitated', context.Source) and not HasStatus('SG_Unconscious', context.Source) and not (not Player(context.Source) and Tagged('AI_IGNORED_TARGET')) and not HasStatus('GNOLL_SUDDENRUSH') and not HasStatus('SHOCKWAVE') and not (HasStatus('MOBILE_NO_AOO', context.Source) and HasStatus('MOBILE_NO_AOO_SOURCE', context.Target)) and not HasStatus('FLAMING_SPHERE_AURA') and not HasStatus('SNEAKING', context.Target) and not HasStatus('SG_Ignore_AOO', context.Target) and not AnyEntityIsItem() and not HasSpellFlag(SpellFlags.IgnoreAoO, context.Target) and not (HasStatus('FANCYFOOTWORK', context.Source, context.Target) and HasStatus('FANCYFOOTWORK_OWNER', context.Target)) and (not HasStatus('PANACHE', context.Source)) or (HasStatus('PANACHE', context.Source) and HasStatus('PANACHE_OWNER', context.Target)) and (not HasStatus('SG_Invisible', context.Target) or Goon_CanSeeInvisible())"
// data "Properties" "UseSpell(Target_ShockingGrasp,true,true,true)"
// data "Cost" "ReactionActionPoint:1"
// data "Stack" "AttackOfOpportunity"
// data "InterruptDefaultValue" "Ask;Enabled"
// data "EnableCondition" "not HasAnyStatus({'SG_Polymorph','SG_Blinded'}) or HasAnyStatus({'SG_Disguise','WILDSHAPE_STARRY_ARCHER_PLAYER','WILDSHAPE_STARRY_CHALICE_PLAYER','WILDSHAPE_STARRY_DRAGON_PLAYER'});"
data "EnableCondition" "(not HasStatus('SG_Polymorph') or Goon_IsUnrestrictedPolymorphStatus()) and not HasStatus('SG_Blinded')"
// data "EnableContext" "OnStatusApplied;OnStatusRemoved"
data "InterruptFlags" "InterruptWhileInvisible"
